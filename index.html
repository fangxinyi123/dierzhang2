<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第二章数据可视化平台</title>
    <link rel="stylesheet" href="./css/style.css">
    <style>
        .debug-info {
            background: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="debug-info">
            <strong>调试信息：</strong> 页面已加载，检查资源路径...
        </div>
        <h1>第二章数据可视化平台</h1>
        
        <div class="chart-container">
            <div class="chart-title">数据可视化图表展示</div>
            <div class="chart-display-area">
                <canvas id="chartCanvas" width="800" height="500"></canvas>
            </div>
            
            <div class="controls">
                <button id="prevChart">上一个图表</button>
                <span class="chart-counter">图表 1/10</span>
                <button id="nextChart">下一个图表</button>
            </div>

            <div id="chartInfo" class="chart-info">
                <!-- 图表信息将动态显示在这里 -->
            </div>
        </div>

        <div class="chart-examples">
            <h3>图表示例</h3>
            <div class="example-grid">
                <div class="example-item">
                    <img src="./images/line_chart.svg" alt="折线图示例" width="200" height="150">
                    <p>折线图 - 显示数据变化趋势</p>
                </div>
                <div class="example-item">
                    <img src="./images/bar_chart.svg" alt="柱形图示例" width="200" height="150">
                    <p>柱形图 - 比较不同类别的数值</p>
                </div>
                <div class="example-item">
                    <img src="./images/pie_chart.svg" alt="饼图示例" width="200" height="150">
                    <p>饼图 - 显示各部分占整体的比例</p>
                </div>
                <div class="example-item">
                    <img src="./images/scatter_plot.svg" alt="散点图示例" width="200" height="150">
                    <p>散点图 - 显示变量间关系</p>
                </div>
            </div>
        </div>

        <div class="info-section">
            <h3>项目说明</h3>
            <p>本项目展示了第二章中介绍的数据可视化技术，包括10种图表类型：</p>
            <ul>
                <li>折线图 - 显示数据变化趋势</li>
                <li>柱形图 - 比较不同类别的数值</li>
                <li>条形图 - 水平排列的分类数据比较</li>
                <li>堆积面积图 - 显示多系列累积变化</li>
                <li>直方图 - 显示数据分布情况</li>
                <li>饼图 - 显示各部分占整体的比例</li>
                <li>散点图 - 显示两个变量之间的关系</li>
                <li>箱形图 - 显示数据分布特征</li>
                <li>雷达图 - 多维数据的可视化</li>
                <li>误差棒图 - 显示测量数据误差</li>
            </ul>
        </div>
    </div>

    <!-- 引入Chart.js库 - 使用本地文件 -->
    <script src="./js/chart.umd.min.js"></script>
    <script>
        // 等待Chart.js加载完成后再加载charts.js
        function loadChartsScript() {
            if (typeof window.Chart !== 'undefined') {
                console.log('Chart.js已加载，开始加载charts.js');
                const script = document.createElement('script');
                script.src = './js/charts.js';
                document.head.appendChild(script);
            } else {
                console.error('Chart.js未加载，延迟重试...');
                setTimeout(loadChartsScript, 100);
            }
        }
        
        // 页面加载完成后开始加载charts.js
        window.addEventListener('DOMContentLoaded', loadChartsScript);
    </script>
    <script>
        // 调试脚本 - 检查资源加载状态
        window.addEventListener('load', function() {
            console.log('页面加载完成');
            console.log('Chart.js 已加载:', typeof window.Chart !== 'undefined');
            console.log('DataVisualization 已加载:', typeof DataVisualization !== 'undefined');
            
            // 检查canvas元素
            const canvas = document.getElementById('chartCanvas');
            console.log('Canvas元素:', canvas);
            if (canvas) {
                console.log('Canvas尺寸:', canvas.width, 'x', canvas.height);
            } else {
                console.error('Canvas元素未找到！');
            }
            
            // 检查按钮
            const prevBtn = document.getElementById('prevChart');
            const nextBtn = document.getElementById('nextChart');
            console.log('上一个按钮:', prevBtn);
            console.log('下一个按钮:', nextBtn);
            
            // 检查图表是否已创建
            const chartInfo = document.getElementById('chartInfo');
            console.log('图表信息区域:', chartInfo ? chartInfo.innerHTML : '未找到图表信息区域');
            
            // 如果Chart.js加载失败，显示错误信息
            if (typeof window.Chart === 'undefined') {
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'background: #ffebee; color: #c62828; padding: 15px; margin: 10px; border: 1px solid #ffcdd2; border-radius: 4px;';
                errorDiv.innerHTML = `
                    <h3>Chart.js加载失败</h3>
                    <p>请检查：</p>
                    <ul>
                        <li>网络连接是否正常</li>
                        <li>CDN链接是否可访问：https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js</li>
                        <li>浏览器控制台是否有错误信息</li>
                    </ul>
                `;
                document.querySelector('.container').insertBefore(errorDiv, document.querySelector('.chart-container'));
            }
        });
    </script>
    
    <!-- 最简图表测试代码 -->
    <div style="margin: 20px; padding: 20px; border: 2px solid #007bff; background: #f8f9fa;">
        <h3>测试图表（最简代码）</h3>
        <canvas id="testChart" width="400" height="200"></canvas>
    </div>
    
    <script>
        // 最简图表测试
        window.addEventListener('load', function() {
            console.log('开始测试最简图表...');
            const testCanvas = document.getElementById('testChart');
            if (testCanvas && typeof window.Chart !== 'undefined') {
                console.log('创建测试图表...');
                try {
                    new window.Chart(testCanvas, {
                        type: 'bar',
                        data: {
                            labels: ['A', 'B'],
                            datasets: [{
                                data: [10, 20],
                                backgroundColor: ['#ff6b6b', '#4ecdc4']
                            }]
                        },
                        options: {
                            responsive: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: '测试图表'
                                },
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                    console.log('测试图表创建成功！');
                } catch (error) {
                    console.error('测试图表创建失败:', error);
                }
            } else {
                console.error('测试图表创建条件不满足:', {
                    canvas: testCanvas,
                    Chart: typeof window.Chart
                });
            }
        });
    </script>
</body>
</html>